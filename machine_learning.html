<!DOCTYPE HTML>
<!--
	Spectral by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Spectral by HTML5 UP</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="landing is-preload">

		<!-- Page Wrapper -->
			<div id="page-wrapper">

				<!-- Header -->
					<header id="header" class="alt">
						<h1><a href="index.html">On the Road</a></h1>
						<nav id="nav">
							<ul>
								<li class="special">
									<a href="#menu" class="menuToggle"><span>Menu</span></a>
									<div id="menu">
										<ul>
											<li><a href="index.html">Home</a></li>
											<li><a href="generic.html">Explore maps</a></li>
											<li><a href="machine_learning.html">Machine Learning</a></li>
										</ul>
									</div>
								</li>
							</ul>
						</nav>
					</header>




                    <section id="machinel" class="wrapper style1 special">
                        <div class="inner">
                            <h2>Machine Learning</h2>
                                    <p> Traffic flow plays a big part when making predictions in relation to car accidents. <br>
                                        Unfortunately this dataset does not have detailed enough flow data to be able to make fair predictions on the accidents.<br>
                                         Due to this issue unsupervised learning was investigated. The method that will be presented is called self organizing maps (SOM). 
                                        The SOM method is a great way to visualize data and try and spot any patterns that might occur. <br>
                                    </p>

                            </header>
                            </ul>
                        </div>
                    </section>
    

					
				
					<!-- unsupervised -->
					<section id="#tester" >
						<div class="inner">						
							<div ><iframe width="100%" height="1240" src="unsupervised.html" frameborder="1px"></iframe></div>
						</div>
					</section>


					

				<!-- Two -->
					<section id="twos" class="wrapper alt style2">
						<section class="spotlight">
							<div class="image"><img src="images/tree.jpg" alt=""></div><div class="content">
								<h2>Supervised learning</h2>
								<p>A random forest model was developed for this dataset. The types of accidents where split into two classes: an accident with injury and an accident without injury. 
                                     There are limitations to this approach when predicting type of car accident only based on weather and location. <br>
                                    Keep in mind that the model's ability to predict type of accidents is not dependent on flow and other
                                     conditions. This model should therefore not be used in actual predictions of accident types.<br>

								</p>
							</div>
						</section>
						<section class="spotlight">
							<div class="image"><img src="images/rf_importance.PNG" alt=""></div><div class="content">
								<h2>Dealing with class imbalance</h2>
								<p>How do we deal with the class imbalance? <br>
                                    The dataset is very unbalanced. This mirrors the reality of accident types, more accidents are without injury than with injury. 
                                    In this dataset 83% of accidents are without injury. 
                                    Creating a completely balanced dataset (50/50), does not mirror the reality however we will still use that method now, 
                                    because the goal with this modelling is to answer the quesetion "given that an accident has occured, would the
                                     individual need to go to the ER?". We do not want to misclassify injuries and non injuries. 
                                     Simply answering this questions besed on the fact that 83% of accident types are 
                                    non injuries would give us a model with 83% accuracy. <br>
                                    <br>
                                    We see on the right that the classifer does not perform well, with a 65% accuracy, both misclassifying injuries as 
                                    non injuries and non injuries as injuries. 
                                    This is still better than a 50/50 guess so our classifier managed to draw some information from our data, although limited and not significant.
                                    <br>
                                    Not that this classifier has a 68% recall for injuries so we could argue that this is better than the model with 83% accuracy, that misclassifies all injuries as non injuries.
							</div>
						</section>
						<section class="spotlight">
                            <div class="image"><img src="images/table.PNG" alt=""></div><div class="content">
                                <h2>Tuning the model</h2>
								<p> We start by splitting the data into a 80% train set and a 20% test set. 
                                    This ensures enough data to train the model on and enough left to test for the expected prediction error. 
                                    <br>
                                    Cross validation is a method to ensure that there is less probability of overfitting our model to a specific 
                                    training set by training our model on different sample data sets and evaluating the model accuracy on the held out
                                     sample. This ensures that the model chosen is less biased.
                                    <br>
                                    We create a hypergrid with different values for the hyperparameters of the Random Forest classifier. 
                                    The parameters we tune can be seen on the right. To select the hyperparameters that give us the best
                                     model accuracy we use 5 fold cross validation. We fit a Random Forest classifier with all combinations 
                                     of these hyperparameters and select the one with the lowest CV error. 
                                    <br>
                                    On the left we see the selected parameters. 

								</p>
							</div>
						</section>

                        <section class="spotlight">
                            <div class="image"><img src="images/rf_impot.PNG" alt=""></div><div class="content">
                                <h2>Variable Importance</h2>
								<p> Here we see which variables are important in our model when making predictions.
                                     The longitude and latitude parameters carry the most importance with hour being a close third,  which is not surprising. 
                                    As seen in our vizualisations these features are correlated with how many accidents occur. 
								</p>
							</div>
						</section>
                        
					</section>

                
                    <section id="machinel2" class="wrapper style1 special">
                        <div class="inner">
                            <h2>What have we learned?</h2>
                                    <p> From our unsupervised learning, the SOM, we saw that we were able to distinguish
                                        the different types of accidents and group them together.
                                        <br> It gave us a good visualization of the 
                                         accidents <br> and we saw that more serious accident were grouped toegther - fatalities and serious injuries.  <br>
                                        <br>

                                        In our supervised learning we didn't learn much about the data when fitting the random forest, but confirmed our hunch that
                                        using only weather and location information do not give us a good prediction of wether a car accident will result in injury. <br>

                                    </p>

                            </header>
                            </ul>
                        </div>
                    </section>

				





				<!-- Footer -->
					<footer id="footer">
						<ul class="copyright">
							<li> 2021 </li><li>DTU: <a href="https://kurser.dtu.dk/course/02806"></a>02806 Social data analysis and visualization</a></li>
						</ul>
					</footer>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>

</html>

